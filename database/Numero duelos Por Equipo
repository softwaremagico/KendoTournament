	SELECT 
			CASE 
				WHEN TotalDuelo1 > TotalDuelo2 THEN t1.Team  
				ELSE t2.Team 
			END as Equipo,
			count(Distinct t1.IdDuelo) as NumVictorias
	FROM 
		(SELECT 
				t2.Name as Team,
				t4.ID as IdDuelo, 
				Sum(CASE 
					WHEN PointPlayer1A in ('K','M','T','D','I')  THEN 1 
					ELSE 0 END + CASE 
									WHEN PointPlayer1B in ('K','M','T','D','I')  THEN 1 
									ELSE 0 END )
				as TotalDuelo1 
		FROM 
				team t2 
				INNER JOIN 
				fight t3 
				ON t2.Name = t3.Team1 
				AND t2.Tournament = t3.Tournament 
				AND (t2.Tournament = 'Prueba' OR 'All' = 'Prueba') 
				INNER JOIN duel t4 
				ON t3.ID = t4.Fight 
		WHERE 
				t2.Position = t4.OrderPlayer 
		GROUP BY
				t2.Name,
				t4.ID 
		)t1 
		INNER JOIN 
		(SELECT 
				t2.Name as Team,
				t4.ID as IdDuelo, 
				Sum(CASE 
					WHEN PointPlayer2A in ('K','M','T','D','I')  THEN 1 
					ELSE 0 END + CASE 
									WHEN PointPlayer2B in ('K','M','T','D','I')  THEN 1 
									ELSE 0 END )
				as TotalDuelo2 
		FROM 
				team t2 
				INNER JOIN fight t3 
				ON t2.Name = t3.Team2 
				AND t2.Tournament = t3.Tournament 
				AND (t2.Tournament = 'Prueba' OR 'All' = 'Prueba')
				INNER JOIN duel t4
				ON t3.ID = t4.Fight
		WHERE 
				t2.Position = t4.OrderPlayer 
		GROUP BY
				t2.Name,
				t4.ID 
		)t2
		ON t1.IdDuelo = t2.IdDuelo 
		WHERE 
				TotalDuelo1 <> TotalDuelo2   
		GROUP BY
				CASE 
					WHEN TotalDuelo1 > TotalDuelo2 THEN t1.Team  
					ELSE t2.Team 
				END